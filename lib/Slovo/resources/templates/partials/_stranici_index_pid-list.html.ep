<%
@$stranici || return;
my $new_subpage_title = '–ù–æ–≤–∞ –ø–æ–¥—Å—Ç—Ä–∞–Ω–∏—Ü–∞';
my $new_celina = '–ù–æ–≤–æ –ø–∏—Å–∞–Ω–∏–µ';
my $list_page_content = '–ü–∏—Å–∞–Ω–∏—è –≤ —Å—Ç—Ä–∞–Ω–∏—Ü–∞';
my $param_pid = param('pid') // 0;
my $time = time;
%>
<!-- _stranici_index_pid-list -->
    <ul class="fa-ul" id="<%= 'pid-' . $stranici->[0]{pid} %>" >
        <%
for my $p (@$stranici) {
    my $fa_class    = 'fa-file';
    my $podstranici = [];
    if ($p->{is_dir}) {
      if ((@$breadcrumb && $p->{id} == $breadcrumb->[0]{pid}) || ($p->{id} == $param_pid))
      {
        $podstranici = stranici->all_for_edit($user, $domain->{domain}, $l,
          {pid => $p->{id}, columns => [@$stranici_columns]});
        shift @$breadcrumb if @$breadcrumb;
      }
      $fa_class = @$podstranici ? 'fa-folder-open' : 'fa-folder';
    }
    my $class = join ' ', map { $p->{$_} ? $_ : () } qw(hidden deleted);
    $class .= ($p->{stop}  // 0) != 0 && ($p->{stop}  // 0) < $time ? ' expired'  : '';
    $class .= ($p->{start} // 0) != 0 && ($p->{start} // 0) > $time ? ' upcoming' : '';
        %>
        <li class="fa-li">
            <i class="fas <%== $fa_class %>"></i>
            <%=
    $p->{is_dir}
      ? link_to $p->{alias} => url_for->query(pid => $p->{id}),
      (class => $class . ($p->{id} == $param_pid ? ' mui--color-deep-orange' : 0))
      : $p->{alias}
                %>
            <div class="mui-dropdown">
                <button class="mui-btn mui-btn--raised mui-btn--small"
                    data-mui-toggle="dropdown">
                <span class="mui-caret"></span>
                </button>
              <ul class="mui-dropdown__menu">
% if ($c->is_item_editable($p)) {
                <li>
                    <%= link_to
                    url_for(edit_stranici => {id => $p->{id}})
                    ->query(language=>$p->{language}) => (title => '–ü—Ä–æ–º—£–Ω–∞') =>
                    begin %><i class="fas fa-edit"></i> –ü—Ä–æ–º—£–Ω–∞<% end %>
                </li>
% }
                <li>
    <%=
    link_to
      'üñ∫ –ü—Ä–µ–≥–ª–µ–¥—ä' =>
      url_for(page => {page => $p->{alias}})->query([–ø—Ä–µ–≥–ª–µ–¥—ä => 1]),
      (title => '–ü—Ä–µ–≥–ª–µ–¥—ä', target => '_blank')
    %>
                </li>

                <li>
    <%=
    link_to  url_for(show_stranici => {id => $p->{id}}),
      (title => '–°–≤–æ–π—Å—Ç–≤–∞', target => '_blank')=> begin %><i
          class="fas fa-info-circle"></i> –°–≤–æ–π—Å—Ç–≤–∞<% end %>
                </li>
% if(!$p->{deleted} && !$p->{hidden}) {
                <li>
    <% if($p->{is_dir}){ %>
    <%= link_to url_with('create_stranici')
      ->query(pid => $p->{id}, dom_id => $p->{dom_id}),
      (title => "$new_subpage_title –Ω–∞ ‚Äû$p->{alias}‚Äù") => begin %><i
          class="fas fa-plus-square"></i> <%= $new_subpage_title %><% end %>
                </li>
    <% } %>
                <li>
    <%= link_to url_with('create_celini')->query(page_id => $p->{id}),
    (title => "$new_celina –≤ ‚Äû$p->{alias}‚Äù") => begin %><i
            class="fas fa-plus-square"></i><i
            class="fas fa-file"></i> <%= $new_celina %><% end %>
                </li>
                <li>
                <%= link_to url_for(celini_in_stranica => page_id => $p->{id}),
        (title => "$list_page_content ‚Äû$p->{alias}‚Äù") => begin %><i
            class="fas fa-bars"></i> <%= $list_page_content %><% end %>
                </li>
% }
              </ul>
            </div>
<%=
$podstranici ? include 'partials/_stranici_index_pid-list' => (stranici => $podstranici): ''
%>
        </li>
<%
}
%>
    </ul>

<!-- end _stranici_index_pid-list -->

