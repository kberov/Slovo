% layout 'upravlenie', title => 'Blog/Celini';
% my $page_id = $c->param('page_id')//0;
<div class="mui-panel breadcrumb">
    %= link_to url_with('create_celini')->query(page_id => $page_id) =>(title=>'ÐÐ¾Ð²Ð° Ñ†Ñ£Ð»Ð¸Ð½Ð°') => begin
    <i class="fas fa-plus-square"></i>
    <% end %>
    <%= link_to
        url_with('home_stranici')->query(pid => $page_id)
        => (title => 'ÐšÑŠÐ¼ ÑÐ¿Ð¸ÑÑŠÐºÐ° ÑÑŠ ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ð¸', style => 'float:right') => begin %>
        <i class="fas fa-file"></i>&nbsp;
    <% end %>
%= link_to  url_with('home_celini')->query(page_id => 0) => sub{'â¸™'}
% if(@$breadcrumb) {
  <%=
  $breadcrumb->map(sub {
    link_to $_->{alias} => url_for()->query(page_id => $_->{id});
  })->join(' â¸™ ')
  %>
% }
</div>




% my @columns = qw(page_id id pid title language alias box); #table columns to show

<div class="mui-container">
    <div class="mui-panel">
<table class="mui-table mui-table--bordered">
        <tr>
            <th></th>
    % for my $column (@columns) {
            <th><%= uc($column) %></th>
    % }
        <th></th>
        </tr>
% for my $item (@$celini) { $item->{is_dir} = 1 if ($item->{permissions} =~ /^d/);
        <tr>
            <th><%= $item->{is_dir} ? 'ðŸ—€' : 'â˜°' %></th>
    % for my $column (@columns) {
      % if ($column eq 'id') {
          <td><%= link_to $item->{id} => show_celini => {id => $item->{id}} %></td>
      % } else {
          <td><%= $item->{$column} %></td>
      % }
    % }
    <td>
        <%= link_to 'ðŸ“' => edit_celini => {id => $item->{id}} %>
        % if(not defined $page_id) {
        <%=
        link_to 'â˜°' =>
          url_with('home_celini')->query(page_id => $item->{page_id}) =>
          (title => 'list siblings')
        %>
        % }
    <%=
    link_to 'ðŸ–¹ðŸ—Œ' => url_with('create_celini')
      ->query(page_id => $item->{page_id}, sorting => ++$item->{sorting}) =>
      (title => 'Add a sibling after this')
    %>
    % if ($item->{permissions} =~/^d/) { # is a container/directory
    <%=
    link_to 'â˜²ðŸ—Œ' => url_with('create_celini')
      ->query(
      page_id => $item->{page_id}, sorting => ++$item->{sorting}, pid => $item->{id}
      ) => (title => 'Add new child content to this')
    %>
    % }
    </td>
        </tr>
% }
</table>
    </div>
</div>
